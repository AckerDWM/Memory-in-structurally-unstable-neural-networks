```{r, fig.height=2, fig.width=6.18}
g_left = qplot(x=c(0, 1), y=c(0, 1), geom="blank") +
  geom_line() +
  labs(x="Time", y="Stimulus amplitude") +
  theme(
    axis.ticks = element_blank(),
    axis.text = element_blank()
  )

g_middle = ggplot(df_cosines, aes(Var1, value, group=Var2, color=replace)) +
  theme_void() +
  geom_line() + 
  xlim(-20, 250) +
  annotate("line", x=151:250, y=PSP_sum+16) +
  annotate("segment", x=110, y=seq(2.5, 30.5, length=15), xend=140, yend=seq(12, 20, length=15)) +
  annotate("point", x=140, y=seq(12, 20, length=15), size=0.5) +
  annotate("text", x=c(-100, 50, 200), y=c(22, 33, 22), label=c("Sensory afferent", "Layer 1", "Layer 2"), size=2.5) +
  scale_color_manual(values=c("black", "red")) +
  theme(legend.position = "none") +
  # axes
  annotate("path", x=c(-10, -10, 30)+1, y=c(15, 11, 11)-10) +
  annotate("text", x=c(-20, 11), y=c(13.05, 10)-10, label=c("Rate", "Time"), size=2.5, angle=c(90, 0))

g_right = ggplot(df_replacement, aes(Var1, value, group=Var2, color=replace)) +
  theme_void() +
  geom_line() + 
  xlim(-20, 250) +
  annotate("line", x=151:250, y=PSP_sum+16) +
  annotate("segment", x=110, y=seq(2.5, 30.5, length=15), xend=140, yend=seq(12, 20, length=15)) +
  annotate("point", x=140, y=seq(12, 20, length=15), size=0.5) +
  scale_color_manual(values=c("black", "blue")) +
  theme(legend.position = "none") +
  ylim(0, 33)

g_legend = qplot(x=c(0,.5), y=c(0,0), geom="line") +
  theme_void() +
  annotate("point", x=.5, y=0) +
  annotate("line", x=c(0,.5), y=c(0,0)+1) +
  ylim(-.5, 1.5) +
  xlim(-1, 2) +
  annotate("text", x=1.3, y=1, label="Neuron", size=2.5) +
  annotate("text", x=1.3, y=0, label="Synapse", size=2.5)

theme_set(theme_classic()+theme(text=element_text(size=8)))
figure = ggdraw() +
  #draw_plot(g_left, x = 0, y = 0, width = 1/3, height = 1) +
  draw_plot(g_middle, x = 0, y = 0, width = .5, height = 1) +
  draw_plot(g_right, x = .5, y = 0, width = .5, height = 1) +
  draw_plot(g_legend, x = .63, y = .8, width = 2/5, height = 1/5) +
  draw_plot_label(label = c("A", "B"), size = 10, x = c(0, .5), y = c(1, 1))

tiff("FIGURE1-test.tiff", width = 3.09, height = 2, units = 'in', res = 300, compression = 'none')
figure # Make plot
dev.off()
```

